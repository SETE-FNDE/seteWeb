<div class="container-fluid">
    <div class="row justify-content-center mb-3">
        <img id="pageIcon" src="./img/icones/importacao.png">
        <p class="pageTitle">Importar Alunos</p>
    </div>

    <div class="row">
        <div class="col-md-10 ml-auto mr-auto">
            <div class="card card-wizard wiz-fixes">
                <div class="card-body ">
                    <ul class="nav nav-tabs">
                        <li class="nav-item ">
                            <a class="nav-link active" href="#tab-planilha-exemplo" data-toggle="tab" role="tab">
                                <img src="./img/icones/tab-table.png" class="wiz-icon">
                                Planilha
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#tab-planilha-preprocessamento" id="tab-pre" data-toggle="tab"
                                role="tab">
                                <img src="./img/icones/tab-xls.png" class="wiz-icon">
                                Base de Dados
                            </a>
                        </li>
                        <li class="nav-item ">
                            <a class="nav-link" href="#tab-planilha-processamento" data-toggle="tab" role="tab">
                                <img src="./img/icones/tab-processamento2.png" class="wiz-icon">
                                Importação
                            </a>
                        </li>
                    </ul>

                    <!-- Abas -->
                    <div class="tab-content">
                        <div class="tab-pane tab-wiz fade show active" id="tab-planilha-exemplo" role="tabpanel">
                            <div class="row justify-content-center">
                                <h6 class="mb-4 mt-1 text-center text-space">
                                    Essa ferramenta possibilita importar vários alunos para o sistema de uma vez a
                                    partir de dados existentes.
                                    <br>
                                    Para tal, por favor baixe a planilha exemplo que deverá ser preenchida com as
                                    seguintes colunas:
                                </h6>
                                <div class="text-space col-12 mb-2 text-center">
                                    <h6 class="text-space">
                                        Campos obrigatórios:
                                    </h6>
                                    <img src="./img/icones/exemplo-importar.png" class="col-12" />
                                </div>
                                <br />
                                <br />
                                <div class="text-space col-12 text-center mt-2">
                                    <h6 class="text-space">
                                        Campos opcionais:
                                    </h6>
                                    <img src="./img/icones/exemplo-importar2.png" class="col-9" />
                                </div>

                                <div class="mt-3 col-12">
                                    <div class="form-group">
                                        <label>
                                            <b>Planilha Exemplo:</b>
                                            <star>*</star>
                                        </label>

                                        <button id="baixarPlanilha" class="col-7 ml-2 mr-2 btn">
                                            <i class="fa fa-download"></i> Baixar Planilha
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab-pane tab-wiz fade" id="tab-planilha-preprocessamento" role="tabpanel">
                            <h6 class="mb-4 text-center text-space">
                                Por favor envie a planilha XLXS contendo a descrição dos alunos que serão importados
                                para o sistema.
                            </h6>
                            <div class="row justify-content-center">
                                <div class="col-12">
                                    <div class="form-group">
                                        <label>
                                            <b>Planilha:</b>
                                            <star>*</star>
                                        </label>
                                        <input type="file" accept=".xlsx" class="file-input" id="arqPlanilha">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab-pane tab-wiz fade" id="tab-planilha-processamento" role="tabpanel">
                            <div class="row justify-content-center">
                                <h6 class="mb-4 mt-1 text-center text-space">
                                    Essa ferramenta possibilita importar os <strong>alunos</strong> da planilha
                                    fornecida.
                                </h6>
                            </div>
                            <div class="row mt-2">
                                <ul class="fa-ul ul-dica">
                                    <li><span class="fa-li">
                                            <i class="fa fa-info-circle"></i></span>
                                        Para selecionar um ou mais alunos, basta clicar no ícone <i
                                            class="fa fa-square-o"></i>
                                    </li>
                                    <li><span class="fa-li"><i class="fa fa-info-circle"></i></span>
                                        Para selecionar todos os alunos, clique no ícone <i class="fa fa-square-o"></i>
                                        no cabeçalho da tabela.
                                    </li>
                                    <li><span class="fa-li"><i class="fa fa-info-circle"></i></span>
                                        Por fim, clique no botão <div class="badge badge-info badge-total badge-censo">
                                            Importar</div>
                                        para concluir o processo.
                                    </li>
                                </ul>
                            </div>
                            <div class="fresh-datatables mr-2">
                                <table id="datatables" class="table table-striped table-no-bordered table-hover"
                                    cellspacing="0" width="100%" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>Nome do Aluno</th>
                                            <th>Data de Nascimento</th>
                                            <th>Georeferenciamento</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    </tbody>
                                </table>
                            </div>

                        </div>
                    </div>

                    <div class="card-footer text-center">
                        <button type="button" class="btn btn-default btn-wd btn-back pull-left">
                            Voltar
                        </button>
                        <button type="button" class="btn btn-info btn-wd btn-next pull-right">
                            Próximo
                        </button>
                        <button type="button" id="importarAlunos" class="btn btn-info btn-wd btn-finish pull-right">
                            Importar
                        </button>
                        <div class="clearfix"></div>
                        <!-- Fim footer -->
                    </div>
                </div>
            </div>

        </div>

    </div>
</div>
</div>

<script>
    if (!isElectron) {
        let jsLoadScript = document.createElement('script');
        jsLoadScript.src = "https://unpkg.com/read-excel-file@5.x/bundle/read-excel-file.min.js";
        document.head.appendChild(jsLoadScript);
        // document.write('<script src="https://unpkg.com/read-excel-file@5.x/bundle/read-excel-file.min.js" async><\/script>');
    }
</script>
<!-- <script src="https://unpkg.com/read-excel-file@5.5.1/bundle/read-excel-file.min.js"></script> -->
<script src="./modules/aluno/aluno-model.js" type="text/javascript"></script>
<script src="./modules/aluno/aluno-importar-ctrl.js" type="text/javascript"></script>